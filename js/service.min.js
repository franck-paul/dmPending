"use strict";dotclear.dmPendingPostsCount=()=>{dotclear.services("dmPendingPostsCount",(e=>{try{const n=JSON.parse(e);if(!n?.success)return void console.log(dotclear.debug&&n?.message?n.message:"Dotclear REST server error");if(n?.payload.ret){const e=n.payload.msg;if(void 0!==e&&e!=dotclear.dbPendingPostsCount_Counter){let t=$('#dashboard-main #icons p a[href="posts.php?status=-2"]');if(t.length){const n=t.children("span.db-icon-title-dm-pending");n.length&&n.text(e)}else if(""!=e&&(t=$('#dashboard-main #icons p a[href="posts.php"]'),t.length)){const n=` <a href="posts.php?status=-2"><span class="db-icon-title-dm-pending">${e}</span></a>`;t.after(n)}const o=n.payload.nb;dotclear.badge($("#pending-posts"),{id:"dmpp",value:o,remove:0==o,type:"soft"}),dotclear.dbPendingPostsCount_Counter=e}}}catch(e){console.log(e)}}),(e=>{console.log(e)}),!0,{json:1})},dotclear.dmPendingPostsView=(e,n="toggle",t=null)=>{if(null==$(e).attr("id"))return;const o=$(e).attr("id").substr(4),s=`dmppe${o}`;let d=document.getElementById(s);d?($(d).toggle(),$(e).toggleClass("expand")):dotclear.getEntryContent(o,(n=>{n?(d=document.createElement("li"),d.id=s,d.className="expand",$(d).append(n),$(e).addClass("expand"),e.parentNode.insertBefore(d,e.nextSibling)):$(e).toggleClass("expand")}),{clean:t.metaKey,length:300})},dotclear.dmPendingCommentsCount=()=>{dotclear.services("dmPendingCommentsCount",(e=>{try{const n=JSON.parse(e);if(!n?.success)return void console.log(dotclear.debug&&n?.message?n.message:"Dotclear REST server error");if(n?.payload.ret){const e=n.payload.msg;if(void 0!==e&&e!=dotclear.dbPendingCommentsCount_Counter){let t=$('#dashboard-main #icons p a[href="comments.php?status=-1"]');if(t.length){const n=t.children("span.db-icon-title-dm-pending");n.length&&n.text(e)}else if(""!=e&&(t=$('#dashboard-main #icons p a[href="comments.php"]'),t.length)){const n=` <a href="comments.php?status=-1"><span class="db-icon-title-dm-pending">${e}</span></a>`;t.after(n)}const o=n.payload.nb;dotclear.badge($("#pending-comments"),{id:"dmpc",value:o,remove:0==o,type:"soft"}),dotclear.dbPendingCommentsCount_Counter=e}}}catch(e){console.log(e)}}),(e=>{console.log(e)}),!0,{json:1}),$.get("services.php",{f:"dmPendingCommentsCount",xd_check:dotclear.nonce}).done((e=>{$("rsp[status=failed]",e).length>0&&window.console.log("Dotclear REST server error")})).fail(((e,n,t)=>{window.console.log(`AJAX ${n} (status: ${e.status} ${t})`)})).always((()=>{}))},dotclear.dmPendingCommentsView=(e,n="toggle",t=null)=>{const o=$(e).attr("id").substr(4),s=`dmpce${o}`;let d=document.getElementById(s);const a=t.metaKey||$(e).hasClass("sts-junk");d?($(d).toggle(),$(e).toggleClass("expand")):dotclear.getCommentContent(o,(n=>{n?(d=document.createElement("li"),d.id=s,d.className="expand",$(d).append(n),$(e).addClass("expand"),e.parentNode.insertBefore(d,e.nextSibling)):$(e).removeClass("expand")}),{metadata:!1,clean:a})},$((()=>{if(Object.assign(dotclear,dotclear.getData("dm_pending")),$.expandContent({lines:$("#pending-posts li.line"),callback:dotclear.dmPendingPostsView}),$("#pending-posts ul").addClass("expandable"),dotclear.dmPendingPosts_Counter){$('#dashboard-main #icons p a[href="posts.php"]').length&&(dotclear.dmPendingPostsCount(),dotclear.dbPendingPostsCount_Timer=setInterval(dotclear.dmPendingPostsCount,6e4))}if($.expandContent({lines:$("#pending-comments li.line"),callback:dotclear.dmPendingCommentsView}),$("#pending-comments ul").addClass("expandable"),dotclear.dmPendingComments_Counter){$('#dashboard-main #icons p a[href="comments.php"]').length&&(dotclear.dmPendingCommentsCount(),dotclear.dbPendingCommentsCount_Timer=setInterval(dotclear.dmPendingCommentsCount,6e4))}}));
