"use strict";dotclear.dmPendingPostsCount=e=>{dotclear.services("dmPendingPostsCount",(n=>{try{const t=JSON.parse(n);if(!t?.success)return void console.log(dotclear.debug&&t?.message?t.message:"Dotclear REST server error");if(t?.payload.ret){const{msg:n}=t.payload;if(void 0!==n&&n!==dotclear.dbPendingPostsCount_Counter){const o=e.attr("href"),d=(o.includes("?")?"&":"?")+"status=-2",s=`${o}${d}`,a=$(`#dashboard-main #icons p a[href="${s}"]`);if(a.length){const t=e.children("span.db-icon-title-dm-pending");t.length&&t.text(n)}else if(""!==n&&e.length){const t=` <a href="${s}"><span class="db-icon-title-dm-pending">${n}</span></a>`;e.after(t)}const{nb:l}=t.payload;dotclear.badge($("#pending-posts"),{id:"dmpp",value:l,remove:0===l,type:"soft"}),dotclear.dbPendingPostsCount_Counter=n}}}catch(e){console.log(e)}}),(e=>{console.log(e)}),!0,{json:1})},dotclear.dmPendingPostsView=(e,n="toggle",t=null)=>{if(void 0===$(e).attr("id"))return;const o=$(e).attr("id").substring(4),d=`dmppe${o}`;let s=document.getElementById(d);s?($(s).toggle(),$(e).toggleClass("expand")):dotclear.getEntryContent(o,(n=>{if(n)return s=document.createElement("li"),s.id=d,s.className="expand",$(s).append(n),$(e).addClass("expand"),void e.parentNode.insertBefore(s,e.nextSibling);$(e).toggleClass("expand")}),{clean:t.metaKey,length:300})},dotclear.dmPendingCommentsCount=e=>{dotclear.services("dmPendingCommentsCount",(n=>{try{const t=JSON.parse(n);if(!t?.success)return void console.log(dotclear.debug&&t?.message?t.message:"Dotclear REST server error");if(t?.payload.ret){const{msg:n}=t.payload;if(void 0!==n&&n!==dotclear.dbPendingCommentsCount_Counter){const o=e.attr("href"),d=(o.includes("?")?"&":"?")+"status=-1",s=`${o}${d}`,a=$(`#dashboard-main #icons p a[href="${s}"]`);if(a.length){const t=e.children("span.db-icon-title-dm-pending");t.length&&t.text(n)}else if(""!==n){const t=` <a href="${s}"><span class="db-icon-title-dm-pending">${n}</span></a>`;e.after(t)}const{nb:l}=t.payload;dotclear.badge($("#pending-comments"),{id:"dmpc",value:l,remove:0===l,type:"soft"}),dotclear.dbPendingCommentsCount_Counter=n}}}catch(e){console.log(e)}}),(e=>{console.log(e)}),!0,{json:1})},dotclear.dmPendingCommentsView=(e,n="toggle",t=null)=>{const o=$(e).attr("id").substring(4),d=`dmpce${o}`;let s=document.getElementById(d);const a=t.metaKey||$(e).hasClass("sts-junk");s?($(s).toggle(),$(e).toggleClass("expand")):dotclear.getCommentContent(o,(n=>{if(n)return s=document.createElement("li"),s.id=d,s.className="expand",$(s).append(n),$(e).addClass("expand"),void e.parentNode.insertBefore(s,e.nextSibling);$(e).removeClass("expand")}),{metadata:!1,clean:a})},dotclear.ready((()=>{if(Object.assign(dotclear,dotclear.getData("dm_pending")),$.expandContent({lines:$("#pending-posts li.line"),callback:dotclear.dmPendingPostsView}),$("#pending-posts ul").addClass("expandable"),$.expandContent({lines:$("#pending-comments li.line"),callback:dotclear.dmPendingCommentsView}),$("#pending-comments ul").addClass("expandable"),dotclear.dmPending_AutoRefresh){if(dotclear.dmPendingPosts_Counter){let e=$('#dashboard-main #icons p a[href="posts.php"]');e.length||(e=$("#dashboard-main #icons p #icon-process-posts-fav")),e.length&&(dotclear.dmPendingPostsCount(e),dotclear.dbPendingPostsCount_Timer=setInterval(dotclear.dmPendingPostsCount,1e3*(dotclear.dmPending_Interval||60),e))}if(dotclear.dmPendingComments_Counter){let e=$('#dashboard-main #icons p a[href="comments.php"]');e.length||(e=$("#dashboard-main #icons p #icon-process-comments-fav")),e.length&&(dotclear.dmPendingCommentsCount(e),dotclear.dbPendingCommentsCount_Timer=setInterval(dotclear.dmPendingCommentsCount,1e3*(dotclear.dmPending_Interval||60),e))}}}));
